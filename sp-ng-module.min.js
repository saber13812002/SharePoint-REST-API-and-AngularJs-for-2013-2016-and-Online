!function(){"use strict";function e(e,t,r){function o(r,o){var n=e.defer();return t({url:o||c+r,method:"GET",headers:{accept:"application/json;odata=verbose","content-Type":"application/json;odata=verbose"}}).success(function(e){n.resolve(e)}).error(function(e,t){n.reject({error:e,status:t})}),n.promise}function n(r,o,n){var s=e.defer();return t({url:n||c+o,method:"POST",headers:{accept:"application/json;odata=verbose","X-RequestDigest":document.getElementById("__REQUESTDIGEST").value,"content-Type":"application/json;odata=verbose"},data:JSON.stringify(r)}).success(function(e){s.resolve(e)}).error(function(e,t){s.reject({error:e,status:t})}),s.promise}function s(r,o,n){var s=e.defer();return t({url:n||c+o,method:"POST",processData:!1,data:r,transformRequest:angular.identity,headers:{accept:"application/json;odata=verbose","X-RequestDigest":document.getElementById("__REQUESTDIGEST").value,"Content-Type":void 0}}).success(function(e){s.resolve(e)}).error(function(e,t){s.reject({error:e,status:t})}),s.promise}function a(r,o,n){var s=e.defer();return t({url:n||c+o,method:"PATCH",headers:{accept:"application/json;odata=verbose","X-RequestDigest":document.getElementById("__REQUESTDIGEST").value,"content-Type":"application/json;odata=verbose","X-Http-Method":"PATCH","If-Match":"*"},data:JSON.stringify(r)}).success(function(e){s.resolve(e)}).error(function(e,t){s.reject({error:e,status:t})}),s.promise}function u(r,o){var n=e.defer();return t({url:o||c+r,method:"DELETE",headers:{accept:"application/json;odata=verbose","X-RequestDigest":document.getElementById("__REQUESTDIGEST").value,"IF-MATCH":"*"}}).success(function(e){n.resolve(e)}).error(function(e,t){n.reject({error:e,status:t})}),n.promise}var c=r?_spPageContextInfo.webAbsoluteUrl:_spPageContextInfo.siteAbsoluteUrl;return{getRequest:o,postRequest:n,updateRequest:a,deleteRequest:u,fileUploadRequest:s,baseUrl:c}}function t(e){return{restrict:"A",link:function(t,r,o){var n=e(o.customFileChange),s=n.assign;r.bind("change",function(){t.$apply(function(){var e=new FileReader;e.onload=function(e){var o={fileName:r[0].files[0].name,fileAsBuffer:e.target.result};s(t,o)},e.onerror=function(e){alert(e.target.error)},e.readAsArrayBuffer(r[0].files[0])})})}}}angular.module("spNgModule",[]).factory("spBaseService",e).directive("customFileChange",t),e.$inject=["$q","$http","IS_APP_WEB"],t.$inject=["$parse"]}(window,document);